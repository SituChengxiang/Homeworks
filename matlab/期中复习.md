# MATLAB期中复习

## 一、数值计算基础

### 1. 误差分析
- **绝对误差**：$e = a - x$
- **相对误差**：$e_r = \\frac{a - x}{a}$
- **有效数字**：若近似值 $x = \\pm 0.a_1 a_2 \\cdots a_n \\times 10^p$ 的绝对误差不超过第 $n$ 位的半个单位，则称 $x$ 有 **$n$ 位有效数字**。

### 2. 数值计算注意事项
- 避免相近数相减
- 防止"大数吃小数"
- 避免除数接近零
- 简化计算步骤，减少运算次数

## 二、非线性方程求根

### 1. 不动点迭代法
$$x^{(k+1)} = \\Phi(x^{(k)})$$

### 2. 牛顿迭代法
$$x^{(k+1)} = x^{(k)} - \\frac{f(x^{(k)})}{f'(x^{(k)})}$$

### 3. 弦截法
$$x^{(k+1)} = x^{(k)} - f(x^{(k)}) \\frac{x^{(k)} - x^{(k-1)}}{f(x^{(k)}) - f(x^{(k-1)})}$$

## 三、常微分方程数值解法

### 1. 欧拉方法
- **显式欧拉法**（前向欧拉）：
  $$y_{n+1} = y_n + h f(x_n, y_n)$$
- **隐式欧拉法**（后向欧拉）：
  $$y_{n+1} = y_n + h f(x_{n+1}, y_{n+1})$$
- **改进欧拉法**：
  $$\\tilde{y}_{n+1} = y_n + h f(x_n, y_n)$$
  $$y_{n+1} = y_n + \\frac{h}{2}[f(x_n, y_n) + f(x_{n+1}, \\tilde{y}_{n+1})]$$

### 2. 休恩方法（Heun Method）

休恩方法（Heun Method）是求解常微分方程的一种数值方法，属于二阶龙格-库塔方法（RK2），也称为改进的欧拉法。

#### 2.1 Heun方法基本公式
Heun方法是一种预测-校正方法，包含两个步骤：
1. **预测步骤**（使用欧拉方法预测）：
   $$y_{n+1}^* = y_n + hf(x_n, y_n)$$
2. **校正步骤**（使用梯形法则校正）：
   $$y_{n+1} = y_n + \\frac{h}{2}[f(x_n, y_n) + f(x_{n+1}, y_{n+1}^*)]$$

这等价于二阶龙格-库塔方法（RK2）：
$$k_1 = f(x_n, y_n)$$
$$k_2 = f(x_n + h, y_n + hk_1)$$
$$y_{n+1} = y_n + \\frac{h}{2}(k_1 + k_2)$$

#### 2.2 三阶龙格-库塔方法（RK3）
$$k_1 = f(x_n, y_n)$$
$$k_2 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$$
$$k_3 = f(x_n + h, y_n - hk_1 + 2hk_2)$$
$$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 4k_2 + k_3)$$

#### 2.3 经典四阶龙格-库塔方法（RK4）
这是最常用的龙格-库塔方法，具有较高的精度和稳定性：
$$k_1 = f(x_n, y_n)$$
$$k_2 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$$
$$k_3 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2)$$
$$k_4 = f(x_n + h, y_n + hk_3)$$
$$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$

#### 2.4 MATLAB实现示例

```matlab
% 四阶龙格-库塔方法实现
function [x, y] = rk4(f, x0, y0, h, x_end)
    x = x0:h:x_end;
    y = zeros(size(x));
    y(1) = y0;
    
    for i = 1:length(x)-1
        k1 = f(x(i), y(i));
        k2 = f(x(i) + h/2, y(i) + h/2*k1);
        k3 = f(x(i) + h/2, y(i) + h/2*k2);
        k4 = f(x(i) + h, y(i) + h*k3);
        
        y(i+1) = y(i) + h/6 * (k1 + 2*k2 + 2*k3 + k4);
    end
end

% 使用示例
% dy/dx = -2*y, y(0) = 1
f = @(x, y) -2*y;
[x, y] = rk4(f, 0, 1, 0.1, 1);
```

### 3. 方法比较

| 方法 | 精度 | 计算量 | 稳定性 | 适用场景 |
|------|------|--------|--------|----------|
| 欧拉法 | 一阶 | 小 | 一般 | 简单问题，精度要求不高 |
| 改进欧拉法 | 二阶 | 中 | 较好 | 一般问题 |
| RK2 | 二阶 | 中 | 较好 | 一般问题 |
| RK4 | 四阶 | 大 | 好 | 精度要求高的问题 |

## 四、线性方程组数值解法

### 1. 直接法
- 高斯消元法
- LU分解

### 2. 迭代法
- 雅可比迭代法
- 高斯-赛德尔迭代法