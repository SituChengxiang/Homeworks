% 使用符号变量避免浮点误差
M = sym([2, -3, 100,   1;
         1, 10, -0.001, 0;
         3, -100, 0.01, 0]);

A = [2, -3, 100;
     1, 10, -0.001;
     3, -100, 0.01];
b = [1;0;0];
disp('Step 0: origin');
disp(M);

% Step 1: 用第1行消去下面两行的第1列
M(1,:) = M(1,:) / M(1,1);  % 主元归一化
M(2,:) = M(2,:) - M(2,1)*M(1,:);
M(3,:) = M(3,:) - M(3,1)*M(1,:);
disp('Step 1: line1');
disp(M);

% Step 2: 处理第2列
M(2,:) = M(2,:) / M(2,2);  % 第二主元归一
M(1,:) = M(1,:) - M(1,2)*M(2,:);
M(3,:) = M(3,:) - M(3,2)*M(2,:);
disp('Step 2: line2');
disp(M);

% Step 3: 处理第3列
M(3,:) = M(3,:) / M(3,3);
M(1,:) = M(1,:) - M(1,3)*M(3,:);
M(2,:) = M(2,:) - M(2,3)*M(3,:);
disp('Step 3: line3（RREF）');
disp(M);

sol = b\A;
disp(sol)