# 第二章：计算函数零点的迭代法 —— 内容整理

本章系统介绍了**非线性方程 $f(x) = 0$** 的数值求解方法，重点围绕**不动点迭代法**与**牛顿法（Newton Method）**，涵盖构造思想、收敛性分析、误差估计及实际编程实现。内容条理清晰、理论与实践结合，适用于科学计算与工程应用。

---

## 一、问题背景

给定一个非线性函数 $f(x)$，求其**零点**（即根）：
$$
f(x) = 0
$$
解析解通常不存在或难以求得，因此需借助**数值迭代方法**近似求解。

---

## 二、不动点迭代法（Fixed-Point Iteration）

### 1. 基本思想

将原方程 $f(x) = 0$ 等价变形为：
$$
x = \Phi(x)
$$
称 $\Phi(x)$ 为**迭代函数**，$x^*$ 满足 $x^* = \Phi(x^*)$ 时称为 **不动点**。

构造迭代格式：
$$
x^{(k+1)} = \Phi\big(x^{(k)}\big), \quad k = 0,1,2,\dots
$$
若序列 $\{x^{(k)}\}$ 收敛，则极限 $x^*$ 即为所求根。

---

### 2. 几何解释

- 在坐标系中画出 $y = \Phi(x)$ 与 $y = x$。
- 从初值 $x^{(0)}$ 出发：
  - 沿水平线到 $y = \Phi(x)$ 得点 $(x^{(0)}, \Phi(x^{(0)}))$
  - 再沿竖直线到 $y = x$ 得 $x^{(1)} = \Phi(x^{(0)})$
- 重复此“之字形”过程，若收敛则逼近交点 $x^*$

> **收敛条件**：$|\Phi'(x^*)| < 1$ （其实类似于牛顿法收敛）

---

### 3. 收敛性定理

#### 定理 2.1-1（全局收敛）

设：

- $\Phi(x) \in C[a,b]$ 一个函数在区间上连续
- $\forall x \in [a,b],\ \Phi(x) \in [a,b]$
- $\Phi(x) \in C^1[a,b]$，（即一阶导数也连续）且存在 $L < 1$，使得 $|\Phi'(x)| \leq L$

则：

- $\Phi(x)$ 在 $[a,b]$ 上有**唯一不动点** $x^*$
- 对任意初值 $x^{(0)} \in [a,b]$，迭代序列收敛于 $x^*$
- 误差估计：
  $$
  |x^{(k)} - x^*| \leq \frac{L^k}{1 - L} |x^{(1)} - x^{(0)}|
  $$

<details>
<summary>证明</summary>

1. **存在性**：
    - 构造辅助函数 $g(x) = x - \Phi(x)$。
    - 根据条件，$\Phi(x)$ 在 $[a,b]$ 上连续，因此 $g(x)$ 也连续。
    - 在端点处：
        - $g(a) = a - \Phi(a)$。因为 $\Phi(a) \in [a,b]$，所以 $\Phi(a) \ge a$，则 $g(a) \le 0$。
        - $g(b) = b - \Phi(b)$。因为 $\Phi(b) \in [a,b]$，所以 $\Phi(b) \le b$，则 $g(b) \ge 0$。
    - 根据**介值定理**，必存在一点 $x^* \in [a,b]$ 使得 $g(x^*) = 0$，即 $x^* = \Phi(x^*)$。证明了不动点存在。

2. **唯一性**：
    - 假设存在两个不同的不动点 $x^*$ 和 $y^*$。
    - 则 $|x^* - y^*| = |\Phi(x^*) - \Phi(y^*)|$。
    - 根据**拉格朗日中值定理**，存在 $\xi \in (x^*, y^*)$ 使得 $\Phi(x^*) - \Phi(y^*) = \Phi'(\xi)(x^* - y^*)$。
    - 因此 $|x^* - y^*| = |\Phi'(\xi)| |x^* - y^*|$。
    - 由条件 $|\Phi'(x)| \le L < 1$，我们得到 $|x^* - y^*| \le L |x^* - y^*|$。
    - 移项得 $(1 - L)|x^* - y^*| \le 0$。
    - 因为 $L < 1$，所以 $1 - L > 0$。因此必有 $|x^* - y^*| = 0$，即 $x^* = y^*$。这与假设矛盾，故不动点唯一。

3. **收敛性与误差估计**：
    - $|x^{(k)} - x^*| = |\Phi(x^{(k-1)}) - \Phi(x^*)| \le L |x^{(k-1)} - x^*|$。
    - 反复使用此不等式，得到 $|x^{(k)} - x^*| \le L^k |x^{(0)} - x^*|$。因为 $L < 1$，当 $k \to \infty$ 时，$L^k \to 0$，所以序列收敛。
    - 对于误差估计，我们有：
      $$
      |x^{(k)} - x^*| \le L^k |x^{(0)} - x^*| = L^k |x^{(0)} - x^{(1)} + x^{(1)} - x^*| \le L^k (|x^{(1)} - x^{(0)}| + |x^{(1)} - x^*|)
      $$
    - 又因为 $|x^{(1)} - x^*| \le L |x^{(0)} - x^*|$，代入上式得到：
      $$
      |x^{(k)} - x^*| \le L^k |x^{(1)} - x^{(0)}| + L^{k+1} |x^{(0)} - x^*|
      $$
    - 这是一个关于 $|x^{(0)} - x^*|$ 的不等式，整理后可得先验估计。
    - 事后误差估计：
      $$
      \begin{aligned}
      &|x^{(k+1)} - x^{(k)}| = |\Phi(x^{(k)}) - \Phi(x^{(k-1)})| \le L |x^{(k)} - x^{(k-1)}|\\
      &|x^{(k)} - x^*| \le |x^{(k)} - x^{(k+1)}| + |x^{(k+1)} - x^*| \le |x^{(k+1)} - x^{(k)}| + L|x^{(k)} - x^*|\\
      &\implies (1-L)|x^{(k)} - x^*| \le |x^{(k+1)} - x^{(k)}| \le L^k |x^{(1)} - x^{(0)}|\\
      &\implies |x^{(k)} - x^*| \le \frac{L^k}{1-L} |x^{(1)} - x^{(0)}|
      \end{aligned}
      $$

</details>

- 一般来讲全局的收敛是比较难的，但局部的条件弱一些；只要初始猜测点和真正的迭代点没有太远，还是有可能收敛成功的。

#### 定理 2.1-2（局部收敛）

> [!IMPORTANT]
> 若 $\Phi'(x)$ 在 $x^*$ 邻域内连续，且 $|\Phi'(x^*)| < 1$，则存在 $\delta > 0$，当 $x^{(0)} \in (x^* - \delta, x^* + \delta)$ 时，迭代收敛。

<details>
<summary>证明</summary>

1. **构造收敛区间**：
    - 因为 $\Phi'(x)$ 在 $x^*$ 处连续且 $|\Phi'(x^*)| < 1$，所以我们可以取一个足够小的正数 $\epsilon$，使得 $L = |\Phi'(x^*)| + \epsilon < 1$。
    - 根据导数连续性的定义，对于这个 $\epsilon$，必然存在一个 $\delta > 0$，使得对于所有 $x \in I = [x^* - \delta, x^* + \delta]$，都有 $|\Phi'(x) - \Phi'(x^*)| < \epsilon$。
    - 这意味着 $|\Phi'(x)| \le |\Phi'(x^*)| + \epsilon = L < 1$ 对于所有 $x \in I$ 成立。

2. **验证全局收敛条件**：
    - 现在我们证明，对于任意 $x \in I$，$\Phi(x)$ 仍然在 $I$ 内。
    - 使用中值定理：$|\Phi(x) - x^*| = |\Phi(x) - \Phi(x^*)| = |\Phi'(\xi)| |x - x^*|$，其中 $\xi$ 在 $x$ 和 $x^*$ 之间。
    - 因为 $x \in I$，所以 $\xi \in I$，因此 $|\Phi'(\xi)| \le L$。
    - 于是 $|\Phi(x) - x^*| \le L |x - x^*|$。
    - 因为 $L < 1$ 且 $|x - x^*| \le \delta$，所以 $|\Phi(x) - x^*| < \delta$。
    - 这表明，只要 $x$ 在区间 $I$ 内，其像 $\Phi(x)$ 也在 $I$ 内。

3. **得出结论**：
    - 我们已经在一个闭区间 $I = [x^* - \delta, x^* + \delta]$ 上满足了**定理 2.1-1**（全局收敛）的所有条件：
        1. $\Phi(x)$ 在 $I$ 上连续可导。
        2. $\Phi(x)$ 将区间 $I$ 映射到自身。
        3. 在 $I$ 上存在一个常数 $L < 1$ 使得 $|\Phi'(x)| \le L$。
    - 因此，对于任何初值 $x^{(0)} \in I$，迭代序列必定收敛到该区间内唯一的不动点 $x^*$。

</details>

#### 定理 2.1-3（局部收敛2）

> [!IMPORTANT]
> 设$x^*$为$\varphi$的不动点，正整数$p\ge 2$,若$\varphi^{(p)}$在$x^*$的某领域内连续，且满足$$\begin{cases} \varphi^{(k)}(x^*)=0, &k=1,2, \ldots ,p-1  \\ , \varphi^{(p)}(x^*)\neq 0  \end{cases}$$
> 则$\{x^{k}\} p$阶局部收敛

---

### 4. 收敛阶（收敛速度）

收敛阶是衡量迭代法收敛速度的重要指标。它描述了迭代过程中误差缩减的快慢。

#### 定义

设序列 $\{x^{(k)}\}$ 收敛于 $x^*$，记误差 $e_k = x^{(k)} - x^*$。如果存在常数 $C > 0$ 和 $p \ge 1$ 使得：
$$
\lim_{k \to \infty} \frac{|e_{k+1}|}{|e_k|^p} = C
$$
则称该迭代法是 **$p$ 阶收敛**的。常数 $C$ 称为**渐进误差常数**。

- **$p=1$ (线性收敛)**：要求 $0 < C < 1$。误差每一步大致缩减一个固定的比例。收敛速度较慢，但稳定。
- **$p=2$ (平方收敛/二阶收敛)**：有效数字的位数大约每一步翻倍，收敛速度非常快。
- **$p > 1$** 统称为**超线性收敛**。

#### 不动点迭代的收敛阶分析

不动点迭代 $x^{(k+1)} = \Phi(x^{(k)})$ 的收敛阶取决于迭代函数 $\Phi(x)$ 在不动点 $x^*$ 处的导数性质。

将 $\Phi(x^{(k)})$ 在 $x^*$ 处进行泰勒展开：
$$
x^{(k+1)} = \Phi(x^{(k)}) = \Phi(x^*) + \Phi'(x^*)(x^{(k)} - x^*) + \frac{\Phi''(x^*)}{2!}(x^{(k)} - x^*)^2 + \cdots
$$
因为 $x^* = \Phi(x^*)$ 且 $e_k = x^{(k)} - x^*$，上式可以写为：
$$
\begin{aligned}
x^* + e_{k+1} &= x^* + \Phi'(x^*)e_k + \frac{\Phi''(x^*)}{2!}e_k^2 + \cdots\\
e_{k+1} &= \Phi'(x^*)e_k + \frac{\Phi''(x^*)}{2!}e_k^2 + \mathcal{O}(e_k^3)
\end{aligned}
$$

根据这个展开式，我们可以分析不同情况：

1. **情况一：$\Phi'(x^*) \ne 0$**
    当 $k$ 足够大时，$e_k$ 很小，高阶项可以忽略。于是：
    $$
    e_{k+1} \approx \Phi'(x^*)e_k \implies \lim_{k \to \infty} \frac{|e_{k+1}|}{|e_k|} = |\Phi'(x^*)|
    $$
    此时，迭代法是**线性收敛**（或称一阶收敛），渐进误差常数为 $C = |\Phi'(x^*)|$。要保证收敛，必须有 $C < 1$。

2. **情况二：$\Phi'(x^*) = 0$ 但 $\Phi''(x^*) \ne 0$**
    此时，泰勒展开式变为：
    $$
    e_{k+1} = \frac{\Phi''(x^*)}{2!}e_k^2 + \mathcal{O}(e_k^3)
    $$
    忽略更高阶的项，我们得到：
    $$
    \lim_{k \to \infty} \frac{|e_{k+1}|}{|e_k|^2} = \left|\frac{\Phi''(x^*)}{2}\right|
    $$
    此时，迭代法是**平方收敛**（或称二阶收敛）。

3. **推广：$p$ 阶收敛**
    若 $\Phi'(x^*) = \Phi''(x^*) = \cdots = \Phi^{(p-1)}(x^*) = 0$，但 $\Phi^{(p)}(x^*) \ne 0$，则迭代法是 **$p$ 阶收敛**，且：
    $$
    \lim_{k \to \infty} \frac{|e_{k+1}|}{|e_k|^p} = \left|\frac{\Phi^{(p)}(x^*)}{p!}\right|
    $$

> **核心结论**：不动点迭代的收敛阶数，等于其迭代函数 $\Phi(x)$ 在不动点 $x^*$ 处**从一阶导数算起，第一个不为零的导数的阶数**。这为我们构造高阶收敛算法提供了理论依据（例如，牛顿法就是通过构造使得 $\Phi'(x^*)=0$ 来实现二阶收敛的）。

---

### 5. 典型例子

#### 例 1：求$f(x) = x^3 - x - 1 = 0$ 在 $x=1.5$ 附近的根

**方法一（收敛）**：
改写为 $x = \sqrt[3]{x + 1}$，即 $\Phi(x) = (x + 1)^{1/3}$

```matlab
x0 = 1.5;
k = 0;
while k < 10
    x1 = (1 + x0)^(1/3);
    if abs(x1 - x0) < 1e-5, break; end
    x0 = x1; k = k + 1;
end
% 结果：k=7, x1 ≈ 1.3247
```

**方法二（发散）**：
改写为 $x = x^3 - 1$，即 $\Phi(x) = x^3 - 1$

```matlab
x0 = 1.5;
for k = 1:5
    x1 = x0^3 - 1;
    x0 = x1;
end
% 结果：x1 → 3.2886e+29 （发散）
```

像这种明显函数图像极快增长的不适合这么迭代

> **结论**：迭代函数的构造至关重要！

---

## 三、牛顿迭代法（Newton-Raphson Method）

### 1. 基本思想：线性化近似

在 $x^{(k)}$ 处对 $f(x)$ 作一阶泰勒展开：
$$
f(x) \approx f(x^{(k)}) + f'(x^{(k)})(x - x^{(k)})
$$
令近似式为 0，解得：
$$
x^{(k+1)} = x^{(k)} - \frac{f(x^{(k)})}{f'(x^{(k)})}
$$

迭代函数为：
$$
\Phi(x) = x - \frac{f(x)}{f'(x)}
$$

---

### 2. 收敛性分析

#### (1) 单重根情形（$f(x^*) = 0,\ f'(x^*) \ne 0$）

- $\Phi'(x^*) = 0$
- **局部二阶收敛**（收敛速度快）
- 一般不动点上二阶导数也不为0

#### (2) 重根情形（$f(x) = (x - x^*)^m g(x),\ g(x^*) \ne 0,\ m \geq 2$）

- 可以用导数的定义算一下
- 牛顿法退化为**一阶收敛**
- **改进方法**：

  **方法 A**（已知重数 $m$）：
  $$
  x^{(k+1)} = x^{(k)} - m \cdot \frac{f(x^{(k)})}{f'(x^{(k)})}
  $$

  **方法 B**（构造新函数）：
  $$
  u(x) = \frac{f(x)}{f'(x)} \quad \Rightarrow \quad x^{(k+1)} = x^{(k)} - \frac{u(x^{(k)})}{u'(x^{(k)})}
  $$

  此时仍为**二阶收敛**

---

### 3. 典型例子

#### 例 2：求 $f(x) = x e^x - 1 = 0$ 在 $(0,1)$ 内的根

- $f'(x) = (1 + x)e^x$
- 牛顿公式：
  $$
  x^{(k+1)} = x^{(k)} - \frac{x^{(k)} e^{x^{(k)}} - 1}{(1 + x^{(k)}) e^{x^{(k)}}}
  $$

```matlab
x0 = 0.5; k = 0;
while k < 10
    x1 = x0 - (x0*exp(x0) - 1) / ((1 + x0)*exp(x0));
    if abs(x1 - x0) < 1e-5, break; end
    x0 = x1; k = k + 1;
end
% 结果：k=3, x1 ≈ 0.5671
```

#### 例 3：求重根 $f(x) = x^4 - 4x^2 + 4 = (x^2 - 2)^2 = 0$ 的根 $x^* = \sqrt{2} \approx 1.4142$

- **标准牛顿法**（一阶收敛）：
  $$
  x^{(k+1)} = x^{(k)} - \frac{(x^{(k)})^2 - 2}{4 x^{(k)}}
  $$
  → 10 次迭代后仍只有 4 位有效数字

- **改进牛顿法（已知 $m=2$）**：
  $$
  x^{(k+1)} = x^{(k)} - 2 \cdot \frac{(x^{(k)})^2 - 2}{4 x^{(k)}} = x^{(k)} - \frac{(x^{(k)})^2 - 2}{2 x^{(k)}}
  $$
  → **2 次迭代**即达 10⁻¹² 精度

- **构造 $u(x) = f(x)/f'(x) = (x^2 - 2)/(4x)$**：
  $$
  x^{(k+1)} = x^{(k)} - \frac{x^{(k)}( (x^{(k)})^2 - 2 )}{(x^{(k)})^2 + 2}
  $$
  → 同样 2 次收敛

> **启示**：对重根问题，必须改进牛顿法！

---

## 四、其他辅助方法

### 1. 二分法（Bisection Method）

- **前提**：$f \in C[a,b]$，且 $f(a)f(b) < 0$
- **步骤**：不断取中点 $c = (a+b)/2$，根据符号缩小区间
- **优点**：**全局收敛**，稳定
- **缺点**：**线性收敛**，速度慢
- **误差**：$|c_n - r| \leq \frac{b - a}{2^{n+1}}$

**MATLAB 实现（函数版）**：

```matlab
function [c, err, yc] = bisect(f, a, b, delta)
    ya = f(a); yb = f(b);
    if ya * yb > 0, error('No sign change!'); end
    max1 = 1 + round((log(b - a) - log(delta)) / log(2));
    for k = 1:max1
        c = (a + b) / 2;
        yc = f(c);
        if yc == 0 || (b - a) < delta, break; end
        if yb * yc > 0, b = c; yb = yc; else, a = c; ya = yc; end
    end
    err = abs(b - a);
end
```

调用：

```matlab
f = @(x) x .* sin(x) - 1;
[c, err, yc] = bisect(f, 0, 2, 1e-6);
% c ≈ 1.1142, err ≈ 1e-6
```

二分法迭代是线性的，比较慢

### 2. Secant Method 弦截法

弦截法可以看作是牛顿法的一种近似，它通过差商代替导数，从而避免了计算导数的麻烦，在很多实际问题中非常有用。

#### 1. 基本思想：用差商近似导数

在牛顿法的迭代公式中：
$$
x^{(k+1)} = x^{(k)} - \frac{f(x^{(k)})}{f'(x^{(k)})}
$$
导数 $f'(x^{(k)})$ 可能难以计算。我们可以用后向差商来近似它：
$$
f'(x^{(k)}) \approx \frac{f(x^{(k)}) - f(x^{(k-1)})}{x^{(k)} - x^{(k-1)}}
$$
将这个近似代入牛顿法公式，就得到了**弦截法的迭代格式**：
$$
x^{(k+1)} = x^{(k)} - f(x^{(k)}) \frac{x^{(k)} - x^{(k-1)}}{f(x^{(k)}) - f(x^{(k-1)})}
$$
该方法需要提供两个初始值 $x^{(0)}$ 和 $x^{(1)}$ 才能启动迭代。

#### 2. 弦截法的几何解释

- 牛顿法是“切线法”，每一步迭代点是函数在当前点切线与 x 轴的交点。
- 弦截法是“割线法”，它取当前点 $(x^{(k)}, f(x^{(k)}))$ 与上一点 $(x^{(k-1)}, f(x^{(k-1)}))$ 连接形成的**割线**（或称弦），计算该割线与 x 轴的交点，作为新的迭代点 $x^{(k+1)}$。

#### 3. 收敛性分析

- **收敛阶**：弦截法的收敛速度介于线性和平方收敛之间，是一种**超线性收敛**。其收敛阶为：
  $$
  p = \frac{1 + \sqrt{5}}{2} \approx 1.618
  $$
  这个值恰好是黄金分割比。
- **收敛速度**：比二分法快，但比牛顿法慢。
- **收敛条件**：与牛顿法类似，它也是局部收敛的，对初值的选取比较敏感。如果初值离根较远，可能会发散。

#### 4. 优缺点

- **优点**：
  - **无需计算导数**，这是它相对于牛顿法最大的优势。
  - 收敛速度比线性收敛快得多。
- **缺点**：
  - 收敛速度慢于牛顿法。
  - 需要两个初始点。
  - 不保证全局收敛。

#### 5. MATLAB 示例

我们再次使用求解 $f(x) = x e^x - 1 = 0$ 的例子来演示弦截法。

```matlab
function secant_example
    f = @(x) x.*exp(x) - 1;
    
    x0 = 0;           % 第一个初值
    x1 = 1;           % 第二个初值
    tol = 1e-8;       % 容差
    maxIter = 20;     % 最大迭代次数
    
    f0 = f(x0);
    f1 = f(x1);
    
    fprintf('k\t x_k\t\t f(x_k)\t\t |x_k - x_{k-1}|\n');
    fprintf('---\t --------\t --------\t --------------\n');
    fprintf('0\t %.8f\t %.2e\n', x0, f0);
    fprintf('1\t %.8f\t %.2e\t %.2e\n', x1, f1, abs(x1-x0));
    
    for k = 2:maxIter
        % 弦截法迭代
        x_next = x1 - f1 * (x1 - x0) / (f1 - f0);
        err = abs(x_next - x1);
        
        f_next = f(x_next);
        fprintf('%d\t %.8f\t %.2e\t %.2e\n', k, x_next, f_next, err);
        
        if err < tol
            break;
        end
        
        % 更新迭代值
        x0 = x1;
        f0 = f1;
        x1 = x_next;
        f1 = f_next;
    end
    
    fprintf('\n弦截法求得的近似解为: %.8f\n', x_next);
end
```

**结果分析**：与牛顿法（3次迭代）相比，弦截法大约需要 5 次迭代达到相似的精度，验证了其收敛速度慢于牛顿法但依然很快的特点。

---

## 五、小结与要点

| 方法 | 收敛性 | 优点 | 缺点 | 适用场景 |
|------|--------|------|------|----------|
| **不动点迭代** | 依赖 $\Phi(x)$ 构造，通常线性 | 简单 | 收敛慢，可能发散 | 初步试探 |
| **牛顿法** | 单根：二阶；重根：一阶 | 收敛快 | 需导数，可能发散 | 高精度求解 |
| **改进牛顿法** | 二阶（重根） | 解决重根问题 | 需知重数或构造新函数 | 重根问题 |
| **二分法** | 线性，全局收敛 | 稳定可靠 | 速度慢 | 根的隔离、初值选取 |

---

## 六、思考与拓展

1. **若只有离散数据点 $(x_i, f(x_i))$，如何构造迭代？**
   → 可用插值（如样条）构造近似函数，再应用牛顿法。

2. **如何求函数极值？**
   → 极值点满足 $f'(x) = 0$，转化为**求导函数的零点**，可用牛顿法求解。

---

> **核心思想**：数值方法的本质是**用简单问题逼近复杂问题**，而**误差控制与收敛性分析**是确保结果可靠的关键。


作业：
- 2.1.4 # 1,4
- 2.2.3 # 11
- 2.4.7 # 15