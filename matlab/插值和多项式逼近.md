# 第四章 插值与多项式逼近

## 4.1 问题提出：为什么需要插值？

在科学计算中，常常遇到如下两类情形：

1. **函数已知但计算复杂**（如 $f(x) = e^x, \sin x, \ln x$）→ 用**多项式逼近**（如泰勒展开）；
2. **函数未知，仅知若干离散点** $(x_i, y_i)$ → 用**插值多项式** $P(x)$ 满足 $P(x_i) = y_i$。

> **插值 vs 拟合**：  
>
> - 插值：**严格过点**，适用于数据精确；  
> - 拟合（第五章）：**不严格过点**，适用于含噪声数据。

---

## 4.2 泰勒多项式逼近（Taylor Polynomial Approximation）

### 1. 定义

设 $f \in C^{N+1}[a,b]$，$x_0 \in [a,b]$，则 $f(x)$ 可写为：
$$
f(x) = P_N(x) + E_N(x)
$$
其中：

- **逼近多项式**：
  $$
  P_N(x) = \sum_{k=0}^{N} \frac{f^{(k)}(x_0)}{k!} (x - x_0)^k
  $$
- **余项（误差）**：
  $$
  E_N(x) = \frac{f^{(N+1)}(c)}{(N+1)!} (x - x_0)^{N+1}, \quad c \in (x, x_0)
  $$

<details>
<summary>误差界推导（简略）</summary>

由积分余项或拉格朗日中值定理可得上述形式。若 $|x - x_0| \le R$，且 $|f^{(N+1)}(x)| \le M$，则：
$$
|E_N(x)| \le \frac{M R^{N+1}}{(N+1)!}
$$
该界随 $N$ 增大而快速减小（阶乘增长快于幂）。
</details>

### 2. 例子：$f(x) = e^x$ 在 $x=0$ 附近

- $P_8(x) = 1 + x + \frac{x^2}{2!} + \cdots + \frac{x^8}{8!}$
- 在 $|x| \le 1$ 内，$M = \max |f^{(9)}(c)| = e^1 \approx 2.718$
- 误差界：
  $$
  |E_8(x)| \le \frac{e \cdot 1^9}{9!} \approx \frac{2.718}{362880} \approx 7.49 \times 10^{-6}
  $$

> 泰勒逼近**局部有效**，离 $x_0$ 越远误差越大。

---

## 4.3 拉格朗日插值（Lagrange Interpolation）

### 1. 问题设定

给定 $n+1$ 个互异节点：
$$
(x_0, y_0), (x_1, y_1), \dots, (x_n, y_n), \quad y_i = f(x_i)
$$
构造 $n$ 次多项式 $P_n(x)$ 使得：
$$
P_n(x_i) = y_i, \quad i = 0,1,\dots,n
$$

### 2. 拉格朗日基函数

定义：
$$
L_k(x) = \prod_{\substack{j=0 \\ j \ne k}}^{n} \frac{x - x_j}{x_k - x_j}
$$
满足：$L_k(x_i) = \delta_{ik}$（Kronecker delta）。

### 3. 插值多项式

$$
P_n(x) = \sum_{k=0}^{n} y_k L_k(x)
$$

<details>
<summary>唯一性证明</summary>

假设存在两个 $n$ 次多项式 $P(x), Q(x)$ 均满足插值条件，则 $R(x) = P(x) - Q(x)$ 为次数 ≤ $n$ 的多项式，且有 $n+1$ 个零点 ⇒ $R(x) \equiv 0$ ⇒ $P = Q$。
</details>

### 4. 例子：$f(x) = \ln x$，节点 $x = [0.4, 0.5, 0.6, 0.7, 0.8]$

- $y = [-0.916291, -0.693147, -0.510826, -0.356675, -0.223144]$
- 用 `lagran.m` 构造插值多项式 $P_4(x)$
- 计算 $\ln(0.54) \approx P_4(0.54) = -0.616186$
- 真值：$\ln(0.54) = -0.616186...$
- 误差：$|E| \approx 10^{-6}$

### 5. 误差公式

若 $f \in C^{n+1}[a,b]$，则：
$$
f(x) - P_n(x) = \dfrac{f^{(n+1)}(c)}{(n+1)!} \prod_{i=0}^{n} (x - x_i), \quad c \in [a,b]
$$

<details>
<summary>🔍 误差界（等距节点）</summary>

设节点等距：$x_k = x_0 + kh$，则对 $n=1,2,3$，有：

- $|E_1(x)| \le \dfrac{h^2 M_2}{8}$
- $|E_2(x)| \le \dfrac{h^3 M_3}{9\sqrt{3}}$
- $|E_3(x)| \le \dfrac{h^4 M_4}{24}$

其中 $M_k = \max |f^{(k)}(x)|$。
</details>

### 6. 缺点

- **无递推性**：增加一个节点，所有 $L_k(x)$ 都要重算；
- **龙格现象**：高次插值在区间端点可能剧烈震荡（如 $f(x) = 1/(1+25x^2)$）。

---

## 4.4 牛顿插值（Newton Interpolation）

### 1. 动机

构造**递推形式**的插值多项式：
$$
P_n(x) = a_0 + a_1(x - x_0) + a_2(x - x_0)(x - x_1) + \cdots + a_n \prod_{i=0}^{n-1}(x - x_i)
$$
优点：增加节点只需加一项。

### 2. 差商（Divided Differences）

定义：

- 零阶差商：$f[x_i] = f(x_i)$
- 一阶差商：$f[x_i, x_{i+1}] = \dfrac{f[x_{i+1}] - f[x_i]}{x_{i+1} - x_i}$
- $k$ 阶差商：
  $$
  f[x_i, \dots, x_{i+k}] = \dfrac{f[x_{i+1}, \dots, x_{i+k}] - f[x_i, \dots, x_{i+k-1}]}{x_{i+k} - x_i}
  $$

差商性质

- **对称性**：差商与节点顺序无关；
- **与导数关系**：若 $f \in C^{n}$，则 $f[x_0, \dots, x_n] = \dfrac{f^{(n)}(c)}{n!}$
- **通过递推关系减少了计算量**

差商构造表：

| $x_k$ | $f[x_k]$ | 一阶 | 二阶 | 三阶 | 四阶 |
|--------|-----------|------|------|------|------|
| 0 | $f[x_0]$ |  |  |  | |
| 1 | $f[x_1]$ | $f[x_0,x_1]$ |  |  | |
| 2 | $f[x_2]$ | $f[x_1,x_2]$ | $f[x_0,x_1,x_2]$ | $f[x_0,x_1,x_2,x_3]$ | |
| 3 | $f[x_3]$ | $f[x_2,x_3]$ | $f[x_1,x_2,x_3]$ | $f[x_1,x_2,x_3,x_4]$ | |
| 4 | $f[x_4]$ | $f[x_3,x_4]$ | $f[x_2,x_3,x_4]$ |$f[x_2,x_3,x_4,x_5]$  | $f[x_0,x_1,x_2,x_3,x_4,x_5]$|
| $\cdots$| $\cdots$|  $\cdots$|  $\cdots$|  $\cdots$| $\cdots$|

### 3. 牛顿插值公式

构造牛顿插值公式时，$a_n$即为对应的差商表的数值

$$
P_n(x) = f[x_0] + f[x_0,x_1](x - x_0) + \cdots + f[x_0,\dots,x_n] \prod_{i=0}^{n-1}(x - x_i)
$$

### 4. 例子：$f(x) = \cos x$，节点 $x = [0,1,2,3,4]$

差商表：

| $x_k$ | $f[x_k]$  | 一阶        | 二阶        | 三阶       | 四阶        |
|-------|-----------|-----------|-----------|----------|-----------|
| 0     | 1.000000  |           |           |          |           |
| 1     | 0.540302  | –0.459698 |           |          |           |
| 2     | –0.416147 | –0.956449 | –0.248376 |          |           |
| 3     | –0.989992 | –0.573846 | 0.191302  | 0.146559 |           |
| 4     | –0.653644 | 0.336350  | 0.455097  | 0.087932 | –0.014657 |

```matlab
X=0:0.1:0.4
Y=cos(X)
[C,D]=newpoly(X,Y)
polyval(C,0.25)-cos(0.25)
```


插值多项式：
$$
\begin{aligned}
P_1(x) &= 1 - 0.459698(x - 0) \\
P_2(x) &= P_1(x) - 0.248376(x - 0)(x - 1) \\
P_3(x) &= P_2(x) + 0.146559(x - 0)(x - 1)(x - 2) \\
P_4(x) &= P_3(x) - 0.014657(x - 0)(x - 1)(x - 2)(x - 3)
\end{aligned}
$$

在 $x=0.5$ 处，$P_4(0.5) \approx 0.87758$，真值 $\cos(0.5) \approx 0.87758$，误差极小。

### 5. 误差项

与拉格朗日相同（因为得到的多项式相同）：
$$
E_n(x) = f[x_0, \dots, x_n, x] \prod_{i=0}^{n}(x - x_i)
$$

---

## 4.5 MATLAB 实现要点

| 任务 | 命令 | 说明 |
|------|------|------|
| 拉格朗日插值 | 自编 `lagran.m` | 返回系数和基函数 |
| 牛顿插值 | 自编 `newton.m` | 利用差商表 |
| 一般插值 | `interp1(x, y, xi, 'method')` | method: `'linear'`（默认）、`'spline'`、`'pchip'`、`'nearest'` |
| 多项式求值 | `polyval(p, x)` | p 为降幂系数向量 |
| 多项式根 | `roots(p)` | |
| 由根构造多项式 | `poly(r)` | |

> 💡 **注意**：`interp1` 的 `'spline'` 使用**三次样条**，不是高次全局多项式，可避免龙格现象。

---

## 4.6 与其他教材观点对比（如 Burden & Faires）

| 本教材 | 经典教材（如 Burden） |
|--------|----------------------|
| 误差界侧重等距节点 | 一般节点 + 余项分析 |
| MATLAB 代码示例多 | 理论推导更严谨 |
| 未提龙格现象 | 明确指出高次插值风险 |

> 📌 **建议**：实际应用中，**避免高次全局插值**，优先使用**分段低次插值**（如三次样条、pchip）。

---

### 总结表

| 方法 | 是否过点 | 是否递推 | 适合次数 | 主要缺点 |
|------|--------|--------|--------|--------|
| 泰勒 | 是（局部） | 否 | 低次 | 仅局部有效 |
| 拉格朗日 | 是 | 否 | ≤10 | 无递推、龙格现象 |
| 牛顿 | 是 | 是 | ≤10 | 仍存在龙格现象 |
| 三次样条 | 是 | — | 分段 3 次 | 不是单一多项式 |

